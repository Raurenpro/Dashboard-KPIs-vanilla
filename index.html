<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <script type="module" src="/main.js"></script>
    <title>Chart.js with Vite</title>
  </head>

  <body>
    <div class="w-screen h-screen bg-black text-white">
      <div class="flex w-full h-full">
        <div class="flex w-[15%] h-full justify-center bg-zinc-800 border-r border-zinc-600 p-5">Titre</div>
        <div class="flex flex-col w-[85%] h-full">
          <div class="flex h-[10%] w-full items-center bg-zinc-800 border-b border-zinc-600 space-x-2 px-5">
            <div class="flex w-[15%] h-full items-center text-center justify-center p-2 font-bold cursor-pointer transition duration-150 hover:bg-sky-700" id="title-1">
              Protection des systèmes et des infrastructures
            </div>
            <div class="flex w-[15%] h-full items-center text-center justify-center p-2 font-bold cursor-pointer transition duration-150 hover:bg-green-700" id="title-2">
              Gouvernance et organisation
            </div>
            <div class="flex w-[15%] h-full items-center text-center justify-center p-2 font-bold cursor-pointer transition duration-150 hover:bg-red-700" id="title-3">
              Titre 2
            </div>
            <div class="flex w-[15%] h-full items-center text-center justify-center p-2 font-bold cursor-pointer transition duration-150 hover:bg-yellow-700" id="title-4">
              Titre 3
            </div>
            <div class="flex w-[15%] h-full items-center text-center justify-center p-2 font-bold cursor-pointer transition duration-150 hover:bg-purple-700" id="title-5">
              Titre 4
            </div>
            <div class="flex w-[15%] h-full items-center text-center justify-center p-2 font-bold cursor-pointer transition duration-150 hover:bg-pink-700" id="title-6">
              Titre 5
            </div>
          </div>
          <div class="flex h-[90%] w-full grid grid-cols-6 grid-rows-5 gap-4 p-5">
            <div id="component-container-1"></div>
            <div id="component-container-2"></div>
            <div id="component-container-3"></div>
            <div id="component-container-4"></div>
            <div id="component-container-5"></div>
            <div id="component-container-6"></div>
            <div id="component-container-7"></div>
            <div id="component-container-8"></div>
            <div id="component-container-9"></div>
          </div>
        </div>
      </div>
    </div>

    <script type="module">
      import { createComponent } from './src/component.js';
      import { createChart } from './src/createChart.js';
      import { nbVul } from './src/charts/nbVul.js';
      import { couvScanVul } from './src/charts/couvScanVul.js';
      import { tauxDispoSI } from './src/charts/tauxDispoSI.js';
      import { vulTraite } from './src/charts/vulTraite.js';
      import { nbConnIP } from './src/charts/nbConnIP.js';
      import { osServMaj } from './src/charts/osServMaj.js';
      import { tauxSurvSysProd } from './src/charts/tauxSurvSysProd.js';
      import { pasPresta } from './src/charts/pasPresta.js';

      const dashboardConfigurations = {
        'title-1': {
          grid: [
            { id: 'component-container-1', classes: 'flex' },
            { id: 'component-container-2', classes: 'flex' },
            { id: 'component-container-3', classes: 'flex' },
            { id: 'component-container-4', classes: 'flex col-span-3 row-span-3' },
            { id: 'component-container-5', classes: 'flex col-span-3 row-span-2' },
            { id: 'component-container-6', classes: 'flex col-span-2 row-span-2' },
            { id: 'component-container-7', classes: 'flex col-span-2 row-span-2' },
            { id: 'component-container-8', classes: 'flex col-span-2' },
            { id: 'component-container-9', classes: 'flex col-span-2' },
          ],
          components: [
            { chartId: 'chart-1', config: vulTraite },
            { chartId: 'chart-2', config: osServMaj },
            { chartId: 'chart-3', config: tauxSurvSysProd },
            { chartId: 'chart-4', config: nbConnIP },
            { chartId: 'chart-5', config: couvScanVul },
            { chartId: 'chart-6', config: nbVul },
            { chartId: 'chart-7', config: tauxDispoSI },
            { chartId: 'chart-8' },
            { chartId: 'chart-9' },
          ]
        },
        'title-2': {
          grid: [
            { id: 'component-container-1', classes: 'flex col-span-2 row-span-2' },
            { id: 'component-container-2', classes: 'flex col-span-2 row-span-2' },
            { id: 'component-container-3', classes: 'flex col-span-2 row-span-2' },
            { id: 'component-container-4', classes: 'flex col-span-2' },
            { id: 'component-container-5', classes: 'flex col-span-2' },
          ],
          components: [
            { chartId: 'chart-1', config: pasPresta },
            { chartId: 'chart-2', config: osServMaj },
            { chartId: 'chart-3', config: tauxSurvSysProd },
            { chartId: 'chart-4', config: nbConnIP },
            { chartId: 'chart-5', config: couvScanVul },
          ]
        },
        'title-3': {
          grid: [
            // Configuration de la grille pour le troisième titre
          ],
          components: [
            // Configuration des composants pour le troisième titre
          ]
        },
      };

      function updateDashboardContent(titleId) {
        const config = dashboardConfigurations[titleId] || { grid: [], components: [] };
        const selectedGridConfig = config.grid;
        const selectedComponents = config.components;

        // Vider les conteneurs existants
        for (let i = 1; i <= 9; i++) {
          const container = document.getElementById(`component-container-${i}`);
          if (container) {
            container.innerHTML = '';
            container.className = ''; // Réinitialiser les classes
          }
        }

        // Mettre à jour les classes des conteneurs de composants
        selectedGridConfig.forEach(config => {
          const container = document.getElementById(config.id);
          if (container) {
            container.className = config.classes;
          }
        });

        // Ajouter les nouveaux composants
        selectedComponents.forEach((component, index) => {
          const container = document.getElementById(`component-container-${index + 1}`);
          if (container) {
            container.appendChild(createComponent(component.chartId));
            if (component.config) {
              createChart(component.chartId, component.config);
            }
          }
        });

        // Mettre à jour la couleur de fond du titre cliqué
        const titles = document.querySelectorAll('[id^="title-"]');
        titles.forEach(title => {
          title.classList.remove('bg-sky-800', 'bg-green-800', 'bg-red-800', 'bg-yellow-800', 'bg-purple-800', 'bg-pink-800');
        });

        const activeTitle = document.getElementById(titleId);
        if (activeTitle) {
          switch (titleId) {
            case 'title-1':
              activeTitle.classList.add('bg-sky-800');
              break;
            case 'title-2':
              activeTitle.classList.add('bg-green-800');
              break;
            case 'title-3':
              activeTitle.classList.add('bg-red-800');
              break;
            case 'title-4':
              activeTitle.classList.add('bg-yellow-800');
              break;
            case 'title-5':
              activeTitle.classList.add('bg-purple-800');
              break;
            case 'title-6':
              activeTitle.classList.add('bg-pink-800');
              break;
          }
        }
      }

      document.addEventListener('DOMContentLoaded', () => {
        const titles = document.querySelectorAll('[id^="title-"]');
        titles.forEach(title => {
          title.addEventListener('click', (event) => {
            const titleId = event.target.id;
            updateDashboardContent(titleId);
          });
        });

        // Initialiser avec le premier titre
        updateDashboardContent('title-1');
      });
    </script>
  </body>
</html>
